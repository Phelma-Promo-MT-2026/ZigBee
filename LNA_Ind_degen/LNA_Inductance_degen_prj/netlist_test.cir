* Qucs 25.1.1  /home/userproj/QucsWorkspace/Zigbee/LNA_Ind_degen/LNA_Inductance_degen_prj/extraction_gm.sch
.INCLUDE "/usr/share/qucs-s/xspice_cmlib/include/ngspice_mathfunc.inc"

.SUBCKT IHP_PDK_nonlinear_components_sg13_lv_nmos  gnd d g s b w=0.35u l=0.34u ng=1 m=1 as=0 ad=0 pd=0 ps=0 trise=0 z1=0.346e-6 z2=0.38e-6 wmin=0.15e-6 rfmode=0 pre_layout=1 mlist=1
X1 d g s b  sg13_lv_nmos w={w} l={l} ng={ng} m={m} as={as} ad={ad} pd={pd} 
+ ps={ps} trise={trise} z1={z1} z2={z2} wmin={wmin} rfmode={rfmode} pre_layout={pre_layout} 
.ENDS
  
.LIB cornerMOSlv.lib mos_tt

V1 _net0 0 DC 2

Xsg13_lv_nmos1 0  _net1 _net2 0 gnd IHP_PDK_nonlinear_components_sg13_lv_nmos w=106U l=0.130U ng=1 m=1 as=0 ad=0 pd=0 ps=0 trise=0 z1=0.346E-6 z2=0.38E-6 wmin=0.15E-6 rfmode=0 pre_layout=1
VIds _net0 _net1 DC 0
V2 _net2 0 DC 0

.control

dc v2 0 3 0.01
let gm = diff(Ids.I,V2)
write spice4qucs.sw1.plot i(VIds) gm
destroy all
reset

op
let gm = diff(Ids.I,V2)
print i(VIds)  gm > spice4qucs.dc1.ngspice.dc.print
destroy all
reset

exit
.endc
.END
